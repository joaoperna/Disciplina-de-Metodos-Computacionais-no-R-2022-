#Limpando a memória global
rm(list= ls())
#Setando o o billing do Google Clound
set_billing_id("teste-base-dos-dados-376717")
#Ativando Bibliotecas
library(tidyverse)
library(basedosdados)
#Setando o o billing do Google Clound
set_billing_id("teste-base-dos-dados-376717")
#Realizando as Querys e baixando o banco de dados
query <-  bdplyr("br_ibge_pib.municipio")
query1 <-  bdplyr("br_ibge_populacao.municipio")
#Puxandos os dados referentes ao Estado do Tocantins da PNADc
pib_per_cap <- basedosdados::read_sql(query = "SELECT pib.id_municipio,pop.ano,  pib.PIB / pop.populacao as pib_pc
FROM `basedosdados.br_ibge_pib.municipio` as pib
INNER JOIN `basedosdados.br_ibge_populacao.municipio` as pop
ON pib.id_municipio = pop.id_municipio AND pib.ano = pop.ano
WHERE pib.id_municipio BETWEEN '1700000' AND '1800000' AND pib.ano BETWEEN 2010 AND 2020")
View(pib_per_cap)
query1 <-  bdplyr("br_ms_atencao_basica.municipio")
query2 <-  bdplyr("br_ms_atencao_basica.municipio")
#
atenca_basica <- basedosdados::read_sql(query = "SELECT *
FROM `basedosdados.br_ms_atencao_basica.municipio`
WHERE id_municipio BETWEEN '1700000' AND '1800000' AND ano BETWEEN 2010 AND 2020")
View(atenca_basica)
glimpse(pib_per_cap)
dados.finais <- bind_rows(id_municipio, ano)
final <- atenca_basica %>%
inner_join(pib_per_cap, by = c('id_municipio' = 'ano'))
rlang::last_error()
glimpse(atenca_basica)
pib_per_cap <- pib_per_cap %>%
mutate(id_municipio = as.character(id_municipio))
final <- atenca_basica %>%
inner_join(pib_per_cap, by = c('id_municipio' = 'ano'))
atenca_basica <- atenca_basica %>%
mutate(id_municipio = as.character(id_municipio))
final <- atenca_basica %>%
inner_join(pib_per_cap, by = c('id_municipio' = 'ano'))
pib_per_cap2 <- pib_per_cap %>%
mutate(id_municipio = as.numeric(id_municipio)) %>%
mutate(ano = as.character(ano)
pib_per_cap2 <- pib_per_cap %>%
pib_per_cap2 <- pib_per_cap %>%
mutate(id_municipio = as.numeric(id_municipio)) %>%
mutate(ano = as.character(ano)
final <- atenca_basica %>%
final <- atenca_basica %>%
inner_join(pib_per_cap, by = c('id_municipio' = 'ano'))
final <- atenca_basica %>%
inner_join(pib_per_cap2, by = c('id_municipio' = 'ano'))
pib_per_cap2 <- pib_per_cap %>%
mutate(id_municipio = as.numeric(id_municipio)) %>%
mutate(ano = as.character(ano)
pib_per_cap2 <- pib_per_cap %>%
pib_per_cap2 <- pib_per_cap %>%
mutate(id_municipio = as.character(id_municipio))
final <- atenca_basica %>%
inner_join(pib_per_cap2, by = c('id_municipio' = 'ano'))
pib_per_cap2 <- pib_per_cap %>%
mutate(id_municipio = as.character(id_municipio)) %>%
mutate(ano = as.character(ano)
View(pib_per_cap2)
View(pib_per_cap2)
View(pib_per_cap2)
glimpse(pib_per_cap2)
View(pib_per_cap2)
View(pib_per_cap2)
pib_per_cap2 <- pib_per_cap %>%
mutate(id_municipio = as.character(id_municipio)) %>%
mutate(ano = as.character(ano)
glimpse(pib_per_cap2)
glimpse(pib_per_cap2)
pib_per_cap2 <- pib_per_cap %>%
mutate(ano = as.character(ano)
glimpse(pib_per_cap2)
glimpse(pib_per_cap2)
final <- pib_per_cap2 %>%
inner_join(antenção, by = c('id_municipio' = 'ano'))
final <- pib_per_cap2 %>%
inner_join(atenca_basica, by = c('id_municipio' = 'ano'))
atenca_basica2 <- atenca_basica %>%
mutate(id_municipio = as.character(id_municipio)) %>%
mutate(ano = as.character(ano)
atenca_basica2 <- atenca_basica %>%
atenca_basica2 <- atenca_basica %>%
mutate(id_municipio = as.character(id_municipio))
final <- atenca_basica2 %>%
inner_join(pib_per_cap2, by = c('id_municipio' = 'ano'))
glimpse(atenca_basica2)
inner_join(pib_per_cap2, by = 'ano'
View(atenca_basica2)
atenca_basica %>% left_join(pib_per_cap, by = c('id_municipio' = 'ano'))
atenca_basica2 %>% left_join(pib_per_cap2, by = c('id_municipio' = 'ano'))
atenca_basica2 %>% left_join(pib_per_cap2, by = c('ano'))
View(atenca_basica2)
glimpse(atenca_basica2)
glimpse(pib_per_cap2)
View(pib_per_cap2)
atenca_basica2 %>% left_join(pib_per_cap2, by = c('id_municipio'))
View(atenca_basica2)
atenca_basica2 %>% left_join(pib_per_cap2, by = c('id_municipio' = 'id_municipio'))
View(atenca_basica2)
glimpse(atenca_basica2)
glimpse(pib_per_cap2)
atenca_basica2 %>% left_join(pib_per_cap2, by = c('id_municipio' = 'id_municipio', 'ano' = 'ano'))
glimpse(atenca_basica2)
final2 <- atenca_basica2  %>%
left_join(pib_per_cap2, by = c('id_municipio' = 'id_municipio'))
View(final2)
final2 <- atenca_basica2  %>%
left_join(pib_per_cap2, by = c('id_municipio' = 'id_municipio', 'ano' = 'ano'))
View(final2)
final2 <- atenca_basica  %>%
left_join(pib_per_cap, by = c('id_municipio' = 'id_municipio', 'ano' = 'ano'))
View(final2)
final2$lpib <- log(final2$pib_pc)
attach(final2)
glimpse(final2)
rgm1 <- lm(lpib ~ carga_horaria_medica_atencao_basica_tradicional + carga_horaria_enfermagem_atencao_basica_tradicional +
proporcao_cobertura_estrategia_saude_familia  + populacao_coberta_total_atencao_basica   )
summary(rgm1)
rgm1 <- lm(lpib ~ carga_horaria_medica_atencao_basica_tradicional + carga_horaria_enfermagem_atencao_basica_tradicional +
proporcao_cobertura_estrategia_saude_familia  + populacao_coberta_total_atencao_basica, na,rm = T)
rgm1 <- lm(lpib ~ carga_horaria_medica_atencao_basica_tradicional + carga_horaria_enfermagem_atencao_basica_tradicional +
proporcao_cobertura_estrategia_saude_familia  + populacao_coberta_total_atencao_basica, data = final2)
summary(rgm1)
rgm1 <- lm(lpib ~ carga_horaria_enfermagem_atencao_basica_tradicional +
proporcao_cobertura_estrategia_saude_familia  + populacao_coberta_total_atencao_basica, data = final2)
summary(rgm1)
rgm1 <- lm(lpib ~ carga_horaria_medica_atencao_basica_tradicional +
proporcao_cobertura_estrategia_saude_familia  + populacao_coberta_total_atencao_basica, data = final2)
summary(rgm1)
rgm1 <- lm(lpib ~ carga_horaria_medica_atencao_basica_tradicional + carga_horaria_enfermagem_atencao_basica_tradicional +
populacao_coberta_total_atencao_basica, data = final2)
summary(rgm1)
rgm1 <- lm(lpib ~ carga_horaria_medica_atencao_basica_tradicional + carga_horaria_enfermagem_atencao_basica_tradicional +
proporcao_cobertura_estrategia_saude_familia, data = final2)
summary(rgm1)
final23 <- final2 %>%
mutate(quantidade_equipes_atencao_basica_equivalente = as.numeric(quantidade_equipes_atencao_basica_equivalente)) %>%
mutate(quantidade_equipes_atencao_basica_parametrizada   = as.numeric(quantidade_equipes_atencao_basica_parametrizada  )) %>%
mutate(quantidade_equipes_atencao_basica_parametrizada  = as.numeric(quantidade_equipes_atencao_basica_parametrizada )) %>%
mutate(quantidade_equipes_saude_familia = as.numeric(quantidade_equipes_saude_familia)) %>%
mutate(quantidade_equipes_atencao_basica_total  = as.numeric(quantidade_equipes_atencao_basica_total )) %>%
mutate(populacao_coberta_estrategia_saude_familia = as.numeric(populacao_coberta_estrategia_saude_familia)) %>%
mutate(populacao_coberta_total_atencao_basica = as.numeric(populacao_coberta_total_atencao_basica))
rgm1 <- lm(lpib ~ carga_horaria_medica_atencao_basica_tradicional + carga_horaria_enfermagem_atencao_basica_tradicional +
proporcao_cobertura_estrategia_saude_familia + populacao_coberta_total_atencao_basica, data = final23)
summary(rgm1)
rgm1 <- lm(lpib ~ carga_horaria_medica_atencao_basica_tradicional + carga_horaria_enfermagem_atencao_basica_tradicional +
proporcao_cobertura_estrategia_saude_familia + populacao_coberta_total_atencao_basica
quantidade_equipes_atencao_basica_equivalente + quantidade_equipes_atencao_basica_parametrizada+
rgm1 <- lm(lpib ~ carga_horaria_medica_atencao_basica_tradicional + carga_horaria_enfermagem_atencao_basica_tradicional +
proporcao_cobertura_estrategia_saude_familia + populacao_coberta_total_atencao_basica+
quantidade_equipes_atencao_basica_equivalente + quantidade_equipes_atencao_basica_parametrizada+
quantidade_equipes_saude_familia + quantidade_equipes_atencao_basica_total +
populacao_coberta_estrategia_saude_familia + populacao_coberta_total_atencao_basica, data = final23)
summary(rgm1)
#
options(scipen = 9999)
summary(rgm1)
save.image('FinalPIBsaude'.rds)
saveRDS("FinalPIBsaude")
saveRDS(final23 ,"FinalPIBsaude")
